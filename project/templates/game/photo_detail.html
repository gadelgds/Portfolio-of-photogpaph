{% extends 'game/base.html' %}

{% block content %}
<h1>{{ photo.title }}</h1>

<!-- –ö–∞—Ç–µ–≥–æ—Ä–∏—è –∏ —Ç–µ–≥–∏ -->
<div style="margin: 10px 0;">
    {% if photo.category %}
    <span style="background: #3498db; color: white; padding: 5px 10px; border-radius: 5px; font-size: 14px;">
        üìÅ {{ photo.category.name }}
    </span>
    {% endif %}
    
    {% if photo.tags.all %}
        {% for tag in photo.tags.all %}
        <span style="background: #ecf0f1; padding: 5px 10px; border-radius: 5px; margin: 5px; display: inline-block; font-size: 14px;">
            üè∑Ô∏è {{ tag.name }}
        </span>
        {% endfor %}
    {% endif %}
</div>

<img src="{{ photo.image.url }}" alt="{{ photo.title }}" style="max-width: 100%; border-radius: 8px; margin-top: 15px;">

<!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –ª–∞–π–∫–∏ -->
<div style="margin: 20px 0; padding: 15px; background: #f5f5f5; border-radius: 8px;">
    <div style="display: flex; gap: 20px; align-items: center;">
        <div style="font-size: 18px;">
            ‚ù§Ô∏è <strong>{{ photo.likes }}</strong> –ª–∞–π–∫–æ–≤
        </div>
        <div style="font-size: 18px;">
            üëÅÔ∏è <strong>{{ photo.views }}</strong> –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤
        </div>
    </div>
    
    {% if messages %}
    <div style="margin-top: 10px;">
        {% for message in messages %}
        <div style="padding: 10px; background: {% if message.tags == 'success' %}#d4edda{% else %}#fff3cd{% endif %}; border-radius: 5px; margin: 5px 0;">
            {{ message }}
        </div>
        {% endfor %}
    </div>
    {% endif %}
    
    <form method="post" action="{% url 'like_photo' photo.id %}" style="margin-top: 15px;">
        {% csrf_token %}
        <button type="submit" class="button" style="background: #ff4757; color: white;">
            ‚ù§Ô∏è –ü–æ—Å—Ç–∞–≤–∏—Ç—å –ª–∞–π–∫
        </button>
    </form>
</div>

<!-- –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∫ —ç—Ç–æ–π —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ -->
<div style="margin: 30px 0;">
    <h3>üí¨ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ ({{ photo_reviews.count }})</h3>
    
    <!-- –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è -->
    <div style="background: #f9f9f9; padding: 20px; border-radius: 8px; margin: 20px 0;">
        <h4>–û—Å—Ç–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</h4>
        <form method="post">
            {% csrf_token %}
            
            <div style="margin-bottom: 15px;">
                <label>{{ form.author_name.label }}</label>
                {{ form.author_name }}
            </div>
            
            <div style="margin-bottom: 15px;">
                <label>{{ form.email.label }}</label>
                {{ form.email }}
            </div>
            
            <div style="margin-bottom: 15px;">
                <label>{{ form.rating.label }}</label>
                {{ form.rating }}
            </div>
            
            <div style="margin-bottom: 15px;">
                <label>{{ form.text.label }}</label>
                {{ form.text }}
            </div>
            
            <button type="submit" class="button">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</button>
        </form>
    </div>
    
    <!-- –°–ø–∏—Å–æ–∫ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ -->
    {% if photo_reviews %}
        {% for review in photo_reviews %}
        <div style="background: white; padding: 15px; border-radius: 8px; margin: 10px 0; border-left: 4px solid #3498db;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                <strong style="font-size: 16px;">{{ review.author_name }}</strong>
                <span style="color: #f39c12; font-size: 18px;">
                    {% for i in "12345" %}{% if forloop.counter <= review.rating %}‚≠ê{% endif %}{% endfor %}
                </span>
            </div>
            <p style="margin: 10px 0; line-height: 1.6;">{{ review.text }}</p>
            <small style="color: #999;">{{ review.created_at|date:"d.m.Y H:i" }}</small>
        </div>
        {% endfor %}
    {% else %}
        <p style="color: #999; text-align: center; padding: 20px;">–ü–æ–∫–∞ –Ω–µ—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤. –ë—É–¥—å—Ç–µ –ø–µ—Ä–≤—ã–º!</p>
    {% endif %}
</div>

<a href="{% url 'home' %}" class="button">–ù–∞–∑–∞–¥ –∫ –≥–∞–ª–µ—Ä–µ–µ</a>
{% endblock %}